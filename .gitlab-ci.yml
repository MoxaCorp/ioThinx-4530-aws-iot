stages:
    - build
    - release

build_aws-iot-sdk-cpp:
    stage: build
    tags:
        - 4530-arm-linux-gnueabihf-5.1
    only:
        - branches
    script:
        - ./setup.sh
        - ./build.sh

release_aws-iot-sdk-cpp:
    stage: release
    tags:
        - 4530-arm-linux-gnueabihf-5.1
    only:
        - tags
    variables:
        REPOSITORY: "git@github.com:kbwilson89/aws-iot-sdk-cpp.git"
        BRANCH: "master"
    script:
        - ./setup.sh
        - ./build.sh
        - git checkout -B $BRANCH
        - git push $REPOSITORY $BRANCH --tags --force

